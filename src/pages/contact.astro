---
/**
 * Contact Page - Contact form for press inquiries and partnership opportunities
 */

import LandingLayout from '../layouts/LandingLayout.astro';
import Navigation from '../components/Navigation.astro';

const WEB3FORMS_ACCESS_KEY = import.meta.env.WEB3FORMS_ACCESS_KEY;
---

<LandingLayout
  title="Contact Us | Stand for Hemp"
  description="Get in touch with Stand for Hemp for press inquiries, partnership opportunities, or to learn more about our mission."
  ogImage="/og-image.png"
>
  <Navigation />

  <!-- Hero Section -->
  <section class="py-16 md:py-24 bg-gradient-to-br from-[var(--color-hemp-green)] to-[var(--color-soil-dark)]">
    <div class="container mx-auto px-6 max-w-4xl text-center">
      <h1 class="text-4xl md:text-6xl font-bold text-white mb-6">
        Get in Touch
      </h1>
      <p class="text-xl md:text-2xl text-white/90 max-w-content mx-auto">
        Questions? Press inquiries? Partnership opportunities? We'd love to hear from you.
      </p>
    </div>
  </section>

  <!-- Contact Form Section -->
  <section class="py-16 md:py-24" style="background-color: var(--color-soft-cream);">
    <div class="container mx-auto px-6 max-w-3xl">
      <div class="card bg-white">
        <h2 class="text-3xl font-bold mb-8 text-center" style="color: var(--color-soil-dark);">
          Send Us a Message
        </h2>

        <form id="contact-form" class="space-y-6" action="https://api.web3forms.com/submit" method="POST">
          <!-- Web3Forms Access Key -->
          <input type="hidden" name="access_key" value={WEB3FORMS_ACCESS_KEY}>

          <!-- Redirect to thank you page after submission -->
          <input type="hidden" name="redirect" value="https://standforhemp.com/contact?success=true">

          <!-- Name -->
          <div>
            <label for="name" class="block text-lg font-semibold mb-2" style="color: var(--color-soil-dark);">
              Name *
            </label>
            <input
              type="text"
              id="name"
              name="name"
              required
              class="w-full px-4 py-3 rounded-lg border-2 border-neutral-300 focus:border-[var(--color-hemp-green)] focus:outline-none transition-colors"
              placeholder="Your name"
            />
          </div>

          <!-- Email -->
          <div>
            <label for="email" class="block text-lg font-semibold mb-2" style="color: var(--color-soil-dark);">
              Email *
            </label>
            <input
              type="email"
              id="email"
              name="email"
              required
              class="w-full px-4 py-3 rounded-lg border-2 border-neutral-300 focus:border-[var(--color-hemp-green)] focus:outline-none transition-colors"
              placeholder="your@email.com"
            />
          </div>

          <!-- Subject -->
          <div>
            <label for="subject" class="block text-lg font-semibold mb-2" style="color: var(--color-soil-dark);">
              Subject *
            </label>
            <select
              id="subject"
              name="subject"
              required
              class="w-full px-4 py-3 rounded-lg border-2 border-neutral-300 focus:border-[var(--color-hemp-green)] focus:outline-none transition-colors"
            >
              <option value="">Select a topic...</option>
              <option value="press">Press Inquiry</option>
              <option value="partnership">Partnership Opportunity</option>
              <option value="general">General Question</option>
              <option value="feedback">Feedback</option>
              <option value="other">Other</option>
            </select>
          </div>

          <!-- Message -->
          <div>
            <label for="message" class="block text-lg font-semibold mb-2" style="color: var(--color-soil-dark);">
              Message *
            </label>
            <textarea
              id="message"
              name="message"
              required
              rows="6"
              class="w-full px-4 py-3 rounded-lg border-2 border-neutral-300 focus:border-[var(--color-hemp-green)] focus:outline-none transition-colors resize-vertical"
              placeholder="Tell us more..."
            ></textarea>
          </div>

          <!-- Submit Button -->
          <div class="text-center">
            <button
              type="submit"
              class="px-10 py-4 text-xl font-bold rounded-lg transition-all hover:transform hover:-translate-y-0.5 hover:shadow-lg"
              style="background-color: var(--color-hemp-green); color: white;"
            >
              Send Message
            </button>
          </div>

          <!-- Success Message -->
          <div id="form-success" class="hidden text-center p-6 rounded-lg" style="background-color: #dcfce7; color: #166534;">
            <p class="text-xl font-semibold mb-2">✓ Message Sent!</p>
            <p>Thank you for reaching out. We'll get back to you as soon as possible.</p>
          </div>

          <!-- Error Message -->
          <div id="form-error" class="hidden text-center p-6 rounded-lg" style="background-color: #fee2e2; color: #991b1b;">
            <p class="text-xl font-semibold mb-2">⚠ Error</p>
            <p>There was a problem sending your message. Please try again or email us directly.</p>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-20 md:py-32 text-center bg-gradient-to-br from-[var(--color-sky-blue)] to-[var(--color-hemp-green)]">
    <div class="container mx-auto px-6 max-w-4xl">
      <h2 class="text-4xl md:text-6xl font-bold text-white mb-6 leading-tight">
        Ready to Take Action?
      </h2>
      <p class="text-xl md:text-2xl text-white/90 mb-10 max-w-content mx-auto">
        Contact your representatives in 60 seconds and help save American hemp
      </p>

      <a
        href="/take-action"
        class="inline-block px-10 py-4 text-xl font-bold rounded-lg transition-all hover:transform hover:-translate-y-0.5 hover:shadow-lg bg-white text-[var(--color-hemp-green)] hover:bg-[var(--color-wheat-gold)]"
      >
        Take Action Now →
      </a>
    </div>
  </section>

  <script>
    // Contact form handler with Web3Forms integration
    const form = document.getElementById('contact-form') as HTMLFormElement;
    const successMsg = document.getElementById('form-success');
    const errorMsg = document.getElementById('form-error');

    // Check if we were redirected back with success parameter
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('success') === 'true') {
      successMsg?.classList.remove('hidden');
      successMsg?.scrollIntoView({ behavior: 'smooth', block: 'center' });
      // Remove the success parameter from URL
      window.history.replaceState({}, '', '/contact');
    }

    if (form) {
      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        // Hide previous messages
        successMsg?.classList.add('hidden');
        errorMsg?.classList.add('hidden');

        // Get form data
        const formData = new FormData(form);

        try {
          // Submit to Web3Forms
          const response = await fetch('https://api.web3forms.com/submit', {
            method: 'POST',
            body: formData
          });

          const data = await response.json();

          if (data.success) {
            // Show success
            successMsg?.classList.remove('hidden');

            // Reset form
            form.reset();

            // Scroll to success message
            successMsg?.scrollIntoView({ behavior: 'smooth', block: 'center' });
          } else {
            throw new Error('Form submission failed');
          }
        } catch (error) {
          console.error('Form submission error:', error);
          // Show error
          errorMsg?.classList.remove('hidden');
          errorMsg?.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
      });
    }
  </script>
</LandingLayout>
