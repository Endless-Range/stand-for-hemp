---
/**
 * Stand for Hemp - Homepage
 *
 * Urgent advocacy platform to mobilize Americans to save the hemp industry.
 * Mobile-first, frictionless design - from landing to action in 60 seconds.
 */

import LandingLayout from '../layouts/LandingLayout.astro';
import Navigation from '../components/Navigation.astro';
import StateImpactGrid from '../components/library/StateImpactGrid.astro';
import { Icon } from 'astro-icon/components';
---

<LandingLayout
  title="Stand for Hemp - Save the US Hemp Industry"
  description="The hemp ban will eliminate thousands of jobs and cost states hundreds of millions. Take action in 60 seconds - contact your representatives to save hemp."
  ogImage="/og-image.jpg"
>
  <Navigation />

  <!-- Hero Section - Dark gradient background -->
  <section class="hero-section relative overflow-hidden py-12 md:py-20">
    <!-- Background gradient -->
    <div class="absolute inset-0 bg-gradient-to-br from-[var(--color-hemp-green)] to-[var(--color-soil-dark)]"></div>

    <!-- Content -->
    <div class="relative z-10 container mx-auto px-6 text-center">
      <!-- Urgency Badge with Logo and Countdown -->
      <div class="mb-6 flex justify-center">
        <div class="urgency-badge" id="countdown-badge">
          <span class="urgency-label">The clock is ticking:</span>
          <span class="countdown-timer">Calculating...</span>
        </div>
      </div>

      <!-- Main Headline -->
      <h1 class="text-4xl md:text-6xl font-bold text-white mb-6 leading-tight">
        They're <span class="text-[var(--color-wheat-gold)]">Killing</span> the Hemp Industry. <br>Fight Back in 
        <span class="text-[var(--color-wheat-gold)]">60 Seconds.</span>
      </h1>

      <!-- Subheadline -->
      <p class="text-xl md:text-2xl text-white/90 mb-8 max-w-reading mx-auto">
        Tell your representatives to stop this. Takes 60 seconds.
      </p>

      <!-- Zip Code Form -->
      <div class="max-w-form mx-auto mb-8">
        <form class="flex flex-col sm:flex-row gap-4" action="/take-action/" method="GET">
          <input
            type="text"
            name="zip"
            inputmode="numeric"
            pattern="[0-9]{5}"
            maxlength="5"
            placeholder="Enter your zip code"
            required
            class="flex-1 px-6 py-4 text-lg rounded-lg border-2 border-white/20 bg-white/95 text-[var(--color-soil-dark)] placeholder-neutral-500 focus:outline-none focus:border-[var(--color-wheat-gold)] focus:ring-2 focus:ring-[var(--color-wheat-gold)]/50"
            aria-label="Enter your 5-digit zip code"
          />
          <button
            type="submit"
            class="btn-primary whitespace-nowrap min-w-[180px]"
          >
            Find My Reps →
          </button>
        </form>
      </div>

      <!-- Social Proof -->
      <div class="text-white/80 text-sm md:text-base">
        <p class="font-semibold text-lg">Join <span id="action-counter" class="text-[var(--color-wheat-gold)]">Loading...</span> Americans taking action</p>
      </div>

      <!-- Petition Link -->
      <div class="mt-6">
        <a
          href="https://c.org/Wn5jc42hcj"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-block px-8 py-3 text-lg font-semibold rounded-lg transition-all hover:transform hover:-translate-y-0.5 hover:shadow-lg border-2 border-white text-white hover:bg-white hover:text-[var(--color-hemp-green)]"
        >
          Sign the National Petition →
        </a>
      </div>
    </div>
  </section>

  <!-- The Crisis - Stats Section -->
  <section class="py-16 md:py-20 bg-white">
    <div class="container mx-auto px-6">
      <div class="text-center mb-12">
        <h2 class="text-3xl md:text-5xl font-bold mb-4" style="color: var(--color-soil-dark);">
          What's at Stake
        </h2>
        <p class="text-xl text-neutral-600 max-w-content mx-auto">
          The hemp ban threatens legitimate businesses, American jobs, and consumer access across all 50 states.
        </p>
      </div>

      <!-- Stats Grid -->
      <div class="grid md:grid-cols-3 gap-6 md:gap-8 max-w-5xl mx-auto mb-8">
        <!-- Stat Card 1 -->
        <div class="stat-card text-center">
          <div class="text-5xl md:text-6xl font-bold mb-3" style="color: var(--color-hemp-green);">
            300,000
          </div>
          <h3 class="text-xl md:text-2xl font-semibold mb-2" style="color: var(--color-soil-dark);">
            Jobs at Risk
          </h3>
          <p class="text-neutral-600">
            Farmers, retailers, and manufacturers across America
          </p>
        </div>

        <!-- Stat Card 2 -->
        <div class="stat-card text-center">
          <div class="text-5xl md:text-6xl font-bold mb-3" style="color: var(--color-hemp-green);">
            $28B
          </div>
          <h3 class="text-xl md:text-2xl font-semibold mb-2" style="color: var(--color-soil-dark);">
            Industry Value
          </h3>
          <p class="text-neutral-600">
            Total hemp market value at risk nationwide
          </p>
        </div>

        <!-- Stat Card 3 -->
        <div class="stat-card text-center">
          <div class="text-5xl md:text-6xl font-bold mb-3" style="color: var(--color-hemp-green);">
            All 50
          </div>
          <h3 class="text-xl md:text-2xl font-semibold mb-2" style="color: var(--color-soil-dark);">
            States Affected
          </h3>
          <p class="text-neutral-600">
            Every state has hemp businesses and jobs at stake
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- State Impact Grid -->
  <section id="impact-map" class="pt-8 pb-16 md:pt-12 md:pb-24 bg-white">
    <div class="container mx-auto px-6">
      <StateImpactGrid />
    </div>
  </section>

  <!-- Why This Matters -->
  <section class="py-16 md:py-24" style="background-color: var(--color-soft-cream);">
    <div class="container mx-auto px-6 max-w-4xl">
      <h2 class="text-3xl md:text-5xl font-bold text-center mb-12" style="color: var(--color-soil-dark);">
        Why Hemp Matters
      </h2>

      <div class="grid md:grid-cols-2 gap-8 md:gap-12">
        <!-- Reason 1 -->
        <div class="card">
          <div class="mb-4">
            <Icon name="fa6-solid:tractor" class="w-12 h-12" style="color: var(--color-hemp-green);" />
          </div>
          <h3 class="text-2xl font-bold mb-3" style="color: var(--color-hemp-green);">
            American Farmers
          </h3>
          <p class="text-lg text-neutral-700 leading-relaxed">
            Hemp is a legal, sustainable crop that supports thousands of American farming families. The ban destroys their livelihoods overnight.
          </p>
        </div>

        <!-- Reason 2 -->
        <div class="card">
          <div class="mb-4">
            <Icon name="fa6-solid:hand-holding-dollar" class="w-12 h-12" style="color: var(--color-hemp-green);" />
          </div>
          <h3 class="text-2xl font-bold mb-3" style="color: var(--color-hemp-green);">
            State Revenue
          </h3>
          <p class="text-lg text-neutral-700 leading-relaxed">
            States collect millions in tax revenue from legal hemp sales. This ban means budget cuts to schools, roads, and public services.
          </p>
        </div>

        <!-- Reason 3 -->
        <div class="card">
          <div class="mb-4">
            <Icon name="fa6-solid:heart-pulse" class="w-12 h-12" style="color: var(--color-hemp-green);" />
          </div>
          <h3 class="text-2xl font-bold mb-3" style="color: var(--color-hemp-green);">
            Americans' Wellness
          </h3>
          <p class="text-lg text-neutral-700 leading-relaxed">
            Millions rely on legal hemp products for sleep, pain relief, and anxiety. The ban pushes them to unregulated black markets.
          </p>
        </div>

        <!-- Reason 4 -->
        <div class="card">
          <div class="mb-4">
            <Icon name="fa6-solid:store" class="w-12 h-12" style="color: var(--color-hemp-green);" />
          </div>
          <h3 class="text-2xl font-bold mb-3" style="color: var(--color-hemp-green);">
            Small Businesses
          </h3>
          <p class="text-lg text-neutral-700 leading-relaxed">
            Thousands of legitimate retailers, manufacturers, and distributors will close. Jobs lost. Communities harmed.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- How It Works -->
  <section class="py-16 md:py-24 bg-white">
    <div class="container mx-auto px-6 max-w-5xl">
      <h2 class="text-3xl md:text-5xl font-bold text-center mb-4" style="color: var(--color-soil-dark);">
        How to Take Action
      </h2>
      <p class="text-xl text-neutral-600 text-center mb-12 max-w-content mx-auto">
        It takes just 60 seconds. Every voice matters.
      </p>

      <!-- Steps -->
      <div class="grid md:grid-cols-3 gap-8 md:gap-12">
        <!-- Step 1 -->
        <div class="text-center">
          <div class="w-20 h-20 mx-auto mb-6 rounded-full flex items-center justify-center text-3xl font-bold text-white" style="background-color: var(--color-hemp-green);">
            1
          </div>
          <h3 class="text-2xl font-bold mb-3" style="color: var(--color-soil-dark);">
            Enter Zip Code
          </h3>
          <p class="text-lg text-neutral-600">
            Find your representatives instantly
          </p>
        </div>

        <!-- Step 2 -->
        <div class="text-center">
          <div class="w-20 h-20 mx-auto mb-6 rounded-full flex items-center justify-center text-3xl font-bold text-white" style="background-color: var(--color-hemp-green);">
            2
          </div>
          <h3 class="text-2xl font-bold mb-3" style="color: var(--color-soil-dark);">
            Choose Action
          </h3>
          <p class="text-lg text-neutral-600">
            Send email or make a phone call (or both!)
          </p>
        </div>

        <!-- Step 3 -->
        <div class="text-center">
          <div class="w-20 h-20 mx-auto mb-6 rounded-full flex items-center justify-center text-3xl font-bold text-white" style="background-color: var(--color-hemp-green);">
            3
          </div>
          <h3 class="text-2xl font-bold mb-3" style="color: var(--color-soil-dark);">
            Share & Amplify
          </h3>
          <p class="text-lg text-neutral-600">
            Spread the word on social media
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Final CTA Section - Sky Blue -->
  <section class="py-20 md:py-32 text-center" style="background-color: var(--color-sky-blue);">
    <div class="container mx-auto px-6 max-w-4xl">
      <h2 class="text-4xl md:text-6xl font-bold text-white mb-6 leading-tight">
        Your Voice Can Save Hemp
      </h2>
      <p class="text-xl md:text-2xl text-white/90 mb-10 max-w-content mx-auto">
        One voice might not be heard. But thousands of voices, all speaking up at once, cannot be ignored.
      </p>

      <!-- Zip Code Form (Duplicate) -->
      <div class="max-w-form mx-auto mb-8">
        <form class="flex flex-col sm:flex-row gap-4" action="/take-action/" method="GET">
          <input
            type="text"
            name="zip"
            inputmode="numeric"
            pattern="[0-9]{5}"
            maxlength="5"
            placeholder="Enter your zip code"
            required
            class="flex-1 px-6 py-4 text-lg rounded-lg border-2 border-white/20 bg-white text-[var(--color-soil-dark)] placeholder-neutral-500 focus:outline-none focus:border-[var(--color-wheat-gold)] focus:ring-2 focus:ring-[var(--color-wheat-gold)]/50"
            aria-label="Enter your 5-digit zip code"
          />
          <button
            type="submit"
            class="btn-primary whitespace-nowrap min-w-[180px]"
          >
            Take Action Now
          </button>
        </form>
      </div>

      <div class="text-white/90 text-lg">
        <p class="font-semibold">Join the movement. Save American hemp.</p>
      </div>
    </div>
  </section>

  <!-- Countdown and Counter Scripts -->
  <script>
    // Countdown Timer to November 12, 2026
    const countdownBadge = document.getElementById('countdown-badge');
    if (countdownBadge) {
      const targetDate = new Date('2026-11-12T00:00:00').getTime();
      const timerElement = countdownBadge.querySelector('.countdown-timer');

      const updateCountdown = () => {
        const now = new Date().getTime();
        const distance = targetDate - now;

        if (distance < 0) {
          if (timerElement) {
            timerElement.textContent = 'THE BAN IS IN EFFECT';
          }
          return;
        }

        // Calculate time units
        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        // Format the countdown display - always show D:H:M:S for interactivity
        const daysText = `${days}D`;
        const hoursText = `${hours.toString().padStart(2, '0')}H`;
        const minutesText = `${minutes.toString().padStart(2, '0')}M`;
        const secondsText = `${seconds.toString().padStart(2, '0')}S`;

        if (timerElement) {
          timerElement.textContent = `${daysText} ${hoursText} ${minutesText} ${secondsText}`;
        }
      };

      // Update immediately and then every second
      updateCountdown();
      setInterval(updateCountdown, 1000);
    }

    // Action counter - fetch from API and add baseline
    const counter = document.getElementById('action-counter');
    if (counter) {
      const BASELINE = 1487; // Starting baseline count

      const animateCounter = (targetNumber) => {
        const duration = 2500; // 2.5 seconds for more visible animation
        const startNumber = Math.max(0, targetNumber - 500); // Start from 500 below target (or 0)
        const increment = (targetNumber - startNumber) / (duration / 16); // 60fps
        let currentNumber = startNumber;

        const updateCounter = () => {
          currentNumber += increment;
          if (currentNumber >= targetNumber) {
            counter.textContent = targetNumber.toLocaleString();
          } else {
            counter.textContent = Math.floor(currentNumber).toLocaleString();
            requestAnimationFrame(updateCounter);
          }
        };

        // Start animation immediately
        updateCounter();
      };

      // Fetch actual count from API
      fetch('/api/stats')
        .then(response => {
          if (!response.ok) {
            throw new Error('API not available');
          }
          return response.json();
        })
        .then(data => {
          const dbCount = data?.stats?.overall?.total_actions || 0;
          const targetNumber = dbCount + BASELINE;
          animateCounter(targetNumber);
        })
        .catch(error => {
          console.log('Using baseline count (API not available in dev mode)');
          // Use baseline if API fails (expected in dev mode)
          animateCounter(BASELINE);
        });
    }
  </script>
</LandingLayout>
